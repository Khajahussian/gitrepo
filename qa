code modified with latest updates
